<div class="container session-manager-container">
  <h2 class="session-manager-header">Edit <%= resource_name.to_s.humanize %></h2>

  <%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
    <%= f.error_notification %>

    <div class="form-inputs container">
      <%= cl_image_tag @user.avatar.key,
      class: "pb-3",
      height: 300, width: 300,
      transformation: [
        { aspect_ratio: :"1.0", crop: :fill, gravity: :face },
        { radius: :max }
        ] unless @user.avatar.key.nil? %>
      <%= f.input :avatar, as: :file %>

      <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
        <p>Currently waiting confirmation for: <%= resource.unconfirmed_email %></p>
      <% end %>
      <%= f.input :first_name,
                  hint: "What's your first name?",
                  required: false,
                  input_html: { autocomplete: "new-password" } %>
      <%= f.input :last_name,
                  hint: "What's your first name?",
                  required: false,
                  input_html: { autocomplete: "new-password" } %>
      <%= f.input :emoji %>
      <%= f.input :email, required: true, autofocus: true %>
      <%= f.input :password,
                  hint: "leave it blank if you don't want to change it",
                  required: false,
                  input_html: { autocomplete: "new-password" } %>
      <%= f.input :password_confirmation,
                  required: false,
                  input_html: { autocomplete: "new-password" } %>
      <%= f.input :current_password,
                  hint: "we need your current password to confirm your changes",
                  required: false,
                  input_html: { autocomplete: "current-password" } %>
    </div>

    <div class="form-actions">
      <%= f.button :submit, "Update", data: { turbo: false } %>
    </div>
  <% end %>

  <hr class="my-5">

  <h3 class="mb-4">Integrations</h3>
  <p class="mb-4">Connect third-party devices to enrich your happiness tracking.</p>

  <% if @user.oura_access_token.present? %>
    <div class="alert alert-success p-3 mb-4">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <strong>âœ“ Oura Ring Connected ğŸ’</strong>
        </div>
        <%= link_to "Manage", connect_oura_connection_path, class: "btn btn-sm btn-outline-secondary" %>
      </div>
    </div>
  <% else %>
    <%= link_to "Do you have an Oura Ring? ğŸ’", connect_oura_connection_path, class: "btn btn-outline-primary btn-lg w-100 mb-5 py-3" %>
  <% end %>

  <h4 class="mb-3">Account Management</h4>

  <p class="mb-4">Manage your account settings and data.</p>
  
  <%= link_to t('account.delete.unhappy_button'), cancel_user_registration_path, class: "btn btn-outline-danger btn-lg w-100 py-3 mb-4" %>
</div>
