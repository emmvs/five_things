<%# ? Loading Screen with Logo %>
<div data-controller="loading" class="loading-screen">
  <%= image_tag "five.png", class: "logo" %>
</div>

<%# ? Dashboard %>
<div class="container p-3">
  <h2 class="dash-box dashboards_header">Hi, <%= current_user.first_name || "Sunshine"%>, and welcome to your Dashboard! ☀️</h2>

  <%= turbo_frame_tag "happy_things_frame_after_create" do  %>

    <%= turbo_frame_tag "happy_things_frame_one" do %>
      <%= link_to 'What made you happy today?',
          new_happy_thing_path,
          class: "btn" %>
    <% end %>

    <%# ? Calendar %>
    <%= month_calendar events: @happy_things, param_name: :date do |date, happy_things| %>
      <%= date %>

      <%= happy_things.each do |happy_thing| %>
        <div><%= happy_thing.title.truncate(20) %></div>
      <% end %>
    <% end %>

    <%# ? HappyThings %>
    <div class="m-3 mt-5">
      <h3>Your Happy Things of today</h3>
      <%= render @happy_things.where("DATE(created_at) = ?", Date.today) %>
    </div>
  <% end %>

  <%# ? PoetrySection %>
  <div class="m-4 mt-5">
    <% if @random_poem %>
      <h3><%= @random_poem["title"] %></h3>
      <h4>by <%= @random_poem["author"] %></h4>
      <% @random_poem["lines"].each do |line| %>
        <p><%= line %></p>
      <% end %>
    <% else %>
      <p>Sorry, could not find a poem of that author today 🙁</p>
    <% end %>
  </div>

  <% if user_signed_in? %>
    <%= link_to "Edit Profile", edit_user_registration_path %>
    <%= button_to "Logout", destroy_user_session_path, method: :delete, class: "btn btn-warning" %>
  <% end %>
</div>
