<%# ? Loading Screen with Logo %>
<div data-controller="loading" class="loading-screen">
  <%= image_tag "five.png", class: "logo", alt: "Five Things Logo" %>
</div>

<%# ? Dashboard %>
<div class="container p-3text-center">
  <h2 class="dash-box mb-5 dashboards_header">Hi, <%= current_user.first_name || "Sunshine"%>, and welcome to your Dashboard! ☀️</h2>

    <%# ? Calendar %>
    <%= month_calendar(events: @happy_things_bubbles, param_name: :date) do |date, happy_things_bubbles| %>
      <div class="day">
        <%= link_to happy_things_path(date_param: date.to_s), class: 'calendar-day-link' do %>
          <%= date.day %>
        <% end %>
      </div>
      <% if happy_things_bubbles.any? %>
        <div class="event-indicator">😊</div> <!-- Emoji indicator -->
      <% end %>
    <% end %>

  <%= turbo_frame_tag "happy_things_frame_after_create" do  %>

    <%= turbo_frame_tag "happy_things_frame_one" do %>
      <%= link_to 'What made you happy today?',
          new_happy_thing_path,
          class: "btn btn-blue shadow m-4" %>
    <% end %>


    <%# ? HappyThings %>
    <div class="m-2 mt-5">
      <h3 class="mb-3">Your Happy Things of today</h3>
      <%= render @happy_things.where("DATE(created_at) = ?", Date.today).reverse %>
    </div>
  <% end %>

  <%# ? PoetrySection %>
  <div class="m-2 mt-5 poetry-box">
    <% if @random_poem %>
      <h3><%= @random_poem["title"] %></h3>
      <h4>by <%= @random_poem["author"] %></h4>
      <% @random_poem["lines"].each do |line| %>
        <p><%= line %></p>
      <% end %>
    <% else %>
      <p>Sorry, could not find a poem of that author today 🙁</p>
    <% end %>
  </div>

    <%# ? Today one year ago Section %>
    <div class="m-2 mt-5">
      <h3 class="mb-3">On this day...</h3>
      <p>Coming Soon</p>
    </div>

  <%= link_to 'See all Happy Things', happy_things_path, class: "btn btn-blue mt-4" %>

  <div class="mt-5">
    <% if user_signed_in? %>
      <%= link_to "Edit Profile", edit_user_registration_path %>
      <%= button_to "Logout", destroy_user_session_path, method: :delete, class: "btn btn-warning" %>
    <% end %>
  </div>
</div>
